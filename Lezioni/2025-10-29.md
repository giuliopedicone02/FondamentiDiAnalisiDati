# Mercoledì 29 ottobre 2025 - Statistica Inferenziale

La statistica inferenziale cerca di usare un approccio formale per capire se i risultati che osservo in un campione valgono anche per la popolazione, e quindi se il campione generalizza la popolazione.

L'approccio Machine Learning consiste nel prendere 1000 persone, dividerle in 3 set (Training, Test, Validation) e valutare il tutto sulla base di quel campione, la statistica inferenziale usa un approcci differente.

Si utilizza nelle previsioni del voto durante le elezioni, per il controllo qualità di lampadine in modo che rispettino un certo standard senza testarle tutte, capire quando una malattia può generare allarme nella popolazione

## L'arte del campionamento

Se sbagliamo il campionamento è un errore che si ripercuote su tutta l'analisi, il modo più semplice di farlo è campionare in maniera puramente casuale la mia popolazione.

Bisogna rispettare le assunzioni di **imparzialità** dove ogni elemento della popolazione ha uguale probabilità di selezione e di **indipendenza** selezionare un elemento non influenza la selezione degli altri

## Bias che è facile inserire durante la fase di campionamento

Il primo caso è detto **selection bias** immaginiamo di voler intervistare delle persone e chiedere qual è la qualità della vita in una determinata città, faccio un sondaggio mettendomi nella piazza centrale del paese ma sto avendo un selection bias in quanto sto intervistando solo le persone che transitano da quella zona e non quelle che abitano in periferia.

Il secondo caso è detto **response bias** avviene nel momento in cui rispondono al sondaggio solo le persone più influenti o più interessati a quell'argomento e altre persone invece non rispondono al sondaggio.

Il terzo caso è detto **coverage bias** avviene nel momento in cui i sondaggi avvengono solo telefonicamente, chi non ha un telefono non sarà intervistato.

La dimensione del campione è importante, avere un campione più o meno grande fa la differenza, supponiamo di dare dei tablet alle scuole cercando di capire se i tablet aumentano le performance degli studenti, nelle scuole grandi non viene influenzato di molto il risultato ma nelle scuole piccole si osserva un aumento delle performance. Nelle scuole piccole è più facile trovare valori estremi

## Campionamento Stratificato

In determinati casi il campionamento random non è sempre una buona idea, supponiamo di voler capire se il grado di istruzione influenza il reddito, se facessi un campionamento random avrei uno sbilanciamento sulle proporzioni, utilizziamo quindi un tipo di campionamento detto **campionamento stratificato**

## Campionamento in Python

Esistono dei metodi che permettono di campionare degli elementi secondo una distribuzione normale, esponenziale, è possibile campionare a partire da un campione ed è possibile farlo anche in maniera stratificata. groupby divide in gruppi e apply li campiona a gruppi da 100.

## Stimare la distribuzione da un campione

Partiamo dall'idea di stimare una statistica come ad esempio la media, mi verrebbe da pensare che in condizioni ideali la media del campione coinciderà con la media della popolazione. Supponiamo di avere un forno che produce biscotti e li impacchetta in confezioni da 1kg, è difficile avere la garanzia di ottenere esattamente 1kg di biscotti ma vorrei che i pacchetti siano tutti simili tra loro. L'idea è quindi prendere dei campioni di confezioni di biscotti e calcolarne il peso medio, supponiamo esca 100.2g. Ripeto l'esperimento ottengo il giorno dopo 999.7g, il giorno dopo ancora 1000.5g. La mia popolazione in questo caso è un concetto teorico, non posso quindi accedere a tutta la popolazione, se prendo un sottoinsieme è difficile ottenere sempre la media di 1kg ma qualcosa che si avvicina molto alla media della popolazione.

## Variabile Random per la media

Creo una nuova variabile aleatoria per la media, significa che il suo valore non è più deterministico ma seguirà una P(X) media. Questa variabile è data dalla somma delle medie diviso il numero di campioni.
Per n abbastanza grande, per il teorema de limite centrale, questa vriabile aleatoria della media seguirà una distribuzione normale. Posso quindi utilizzare le caratteristiche di questa distribuzion per trarre dei ragionamenti


## Distribuzioni delle medie

Ci permette di capire come cambia la mia stima delle medie dei campioni nel tempo.

$$
E[\overline{X}] = E\left[\frac{1}{n} \sum_{i=1}^n X_i\right] = \frac{1}{n} \sum_{i=1}^n E[X_i] = \mu
$$

$$
Var[\overline{X}] = Var\left[\frac{1}{n} \sum_{i=1}^n X_i\right] = \frac{1}{n^2} \sum_{i=1}^n Var[X_i] = \frac{\sigma^2}{n}
$$

$$
Std[\overline{X}] = \frac{\sigma}{\sqrt{n}}
$$

La media converge a $\mu$ la deviazione standard dipende da $\sigma$ e da n che è invece una cosa che posso controllare più n cresce più la deviazione standard diminuisce. Con campioni molto grandi riesco a stimare bene la media della popolazione, questa è una giustificazione matematica che ci permette ancora meglio di capire perchè i campioni grandi sono i migliori.

Per sigma più piccolo ottengo una distribuzione più concentrata, quando sigma è più alto una singola stima può discostarsi molto dalla media. Ma come faccio a calcolare la deviazione standard se ho bisogno di sigma e sigma non la posso calcolare? Utilizziamo uno stimatore

## Quantificare l'incertezza

Utilizziamo uno stimatore chiamato Standard Error è una misura di quanto sono accurato ed è dato da:

$$
SE(\overline{x}) = \frac{s_{n-1}}{\sqrt{n}}
$$

Se volessi migliore l'accuratezza se raddoppio la dimensione del campione l'errore si rudice del 30%, se quadruplico il campione l'errore si riduce del 50%. Spesso lo Standard Error è proporzionale ad 1/sqrt(n)

## La distribuzione di Student (t)

Esiste una distribuzione che permette di far dipendere la dispersione della distribuzione anche da n. Si definisce a partire da un parametro n-1 detto **gradi di libertà** definita come:

$$
t_{n-1} = \frac{\overline{X} - \mu}{s_{n-1} / \sqrt{n}}
$$

Questa formula somiglia molto allo z-scoring, solo che la deviazione standard non avendola divido per lo Standard Error (SE).

Se andassi a variare i gradi di libertà per un dof basso la distribuzione è più dispersa, per dof più alti (n>=30) la distribuzione tende a convergere alla distribuzione Gaussiana.

## Intervalli di Confidenza

Immaginiamo di avere una stima delle medie della popolazione, la distribuzione nè centrata sulla media ed ha una certa deviazione standard, so inoltre che tra -3sigma e +3sigma ho il 99% dei dati.

Definisco il livello di confidenza come un valore (solitamente 95%) o il livello di significatività alpha (solitamente 0.05) dato da 1 - livello di confidenza.

Mi servono la media del campione, la stima della deviazione standard e lo standard error, da questi valori ottengo sostitendo nella formula ottengo un intervallo di confidenza e posso quindi dire che il 95% delle volte la media della mia popolazione sta proprio in quell'intervallo.

## Inferenca tramite ricampionamento

La mediana non ha una formulazione matematica a differenza della media. Sono state sviluppate delle tecniche dette **non parametriche** con un metodo detto **Bootstrapping**. Consiste nell'effettuare tanti campionamenti con ripetizioni in modo da avere variabilità, trovo la media e la mediana in modo empirico e per trovare gli intervalli di confidenza utilizzo i percentili (2.5% e 97.5%) in modo che il 5% sia equamente distribuito a sinistra e destra. Se i dati sono pochi e non possiamo applicare quindi il teorema del limite centrale è consigliato utilizzare il bootstrapping.

## Bias di uno stimatore

Concetto che affonda le sue radici nella statistica, le formule che si utilizzano a partire da un campione prende il nome di **stimatore**. Ciò che esce fuori da questa formula prende il nome di **stima** dato che T dipende dal campione anch'essa è una variabile aleatoria e può non essere accurata. Per misurare questa inaccuratezza definiamo il bias dello stimatore come la differenza tra il valore atteso di T(X) - $\phi$. Nel caso della media avremo bias 0.

Il bias ci dice qual è l'errore sistematico nella stima, un valore nullo indica che in media la mia stima è corretta, un valore diverso da zero indica sottostima o sovrastima.

Lo stimatore non distorto della varianza è calcolato come:

Il valore atteso dello stimatore della varianza sarà uguale a:

Se uso lo stimatore non distorto convergerò alla statistica ma quanto sarò accurato? La Varianza dello stimatore si calcola come nel caso delle variabili aleatorie.

## Trade-off della varianza

Se abbasso il bias tendenzialmente alzo la varianza, se abbasso la varianza tendo ad alzare il bias.

In generale un bias basso indica che le stime sono vicine al valore effettivo, una varianza bassa indica che le stime sono tutte vicine tra loro.

- Bias basso, varianza bassa: Situazione ideale, le mie stime sono sempre molto accurate
- Bias basso, varianza alta: stime ben centrate ma molto sparse (Le reti neurali fanno parte di questa categoria)
- Bias alto, varianza bassa: stime concentrate ma non centrate correttamente e quindi sbagliate (Percettrone, Regressore logistico)
- Bias alto, varianza alta: Situazione peggiore, stime sparse e non centrate correttamente

La regolarizzazione è una tecnica che mi permette di abbassare la varianza alzando il bias

## Test di ipotesi

L'idea del test di ipotesi nasce dal problema che le stime puntuali possono avere dei problemi, calcolo quindi l'intervallo di confidenza, cerca di rispondere a domande secche del tipo:

- la media dei pacchetti dei biscotti è esattamente 1kg
- due forni diversi ci danno biscotti con lo stesso peso medio
- la proporzione dei pacchetti che hanno peso 1kg è sotto una certa soglia

Ci permette di capire se una determinata ipotesi è verificata o meno, viene utilizzato per sfidare una determinata assunzione sui parametri relativa ad un parametro. Se l'ipotesi viene rigettata diciamo che la nostra affermazione è falsa, se non riesco a rigettare l'ipotesi non è sempre facile dire che l'ipotesi è vera ma siamo nel caso in cui non ho abbastanza strumenti per poter dire che l'ipotesi va rigettata.

## Test di ipotesi sui biscotti

Immaginiamo di avere una media di 1000.0005g ed uno standard error di 0.01g.

L'ipotesi nulla (H0) ci dice che la popolazione media è di 1000g. L'ipotesi alternativa (H1) indica invece che la media della popolazione è diversa da 1000g.

L'ipotesi nulla è l'ipotesi che stiamo cercando di rigettare, ci chiediamo qual è il margine di errore che vogliamo accettare impostando un livello di significatività alpha=0.05

## Test Statistici

Scelgo una distribuzione sulla base delle mie assunzioni, la mia ipotesi nulla ha a che fare con delle medie quindi con n molto grandi il comportamento si adatterà a quello della Gaussiana, ma avendo pochi campioni è meglio utilizzare la distribuzione di Student.

Ci chiediamo quanto la media del campione si discosta dalla media dell'ipotesi nulla.

Per rispondere a questa domanda utilizziamo la statistica:

$$
t = \frac{\overline{x} - \mu_0}{s_{n-1}/\sqrt{n}} = \frac{1000.0005 - 1000}{0.01 / \sqrt{1000}} = 1.58
$$

il valore 1.58 va confrontato con la distribuzione t di Student, qual è la probabilità che io trovo qualcosa di più estremo di quello che sto osservando? Questa probabilità è l'area sotto la curva calcolata in maniera semplice utilizzando la CDF.

Questo numero che esce fuori, è la probabilità di osservare una statistica più estrema di quella che stiamo osservando e questo valore prende il nome di `p-value` e si calcola come:

$$\text{p-value} = 2(1-CDF_t(t))$$

Nel nostro caso otteniamo un p-value di 0.11 significa che l'11% delle volte ottengo una distribuzione più estrema di quella che sto osservando. Essendo p-value > 0.05 rigetto l'ipotesi nulla, quando non riesco a rigettare l'ipotesi nulla non sto dimostrando che l'ipotesi alternativa è vera ma non ho abbastanza strumenti per dire che l'ipotesi nulla è falsa quindi "accetto" l'ipotesi alternativa.

## Capire i test di errore

Gli errori vengono categorizzati in due tipi:

- H0 è vera ed io lo rigetto (errore di tipo 1)
- H0 è vera ed io non lo rigetto
- H0 è falso ed io la rigetto
- H0 è falso ed io non la rigetto (errore di tipo 2)

## Test ad una coda e test a due code

Nel caso di test a due code ci chiediamo se l'ipotesi alternativa ha la forma in cui la media è diversa da mu0, se mu > mu0 abbiamo un test ad una coda stessa cosa per mu < mu0

## Test comuni

- Test ad un campione
- Test a due campioni
- Test Chi quadrato
- Test di correlazione

